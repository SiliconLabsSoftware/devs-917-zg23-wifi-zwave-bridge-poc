<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>917 ZG23 WiFi ZWave Bridge: Security Scheme 0</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">917 ZG23 WiFi ZWave Bridge
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Security Scheme 0 </div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9f0c343b5ae18964fdbf640727d3a63d" id="r_ga9f0c343b5ae18964fdbf640727d3a63d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9f0c343b5ae18964fdbf640727d3a63d">sec0_register_nonce</a> (uint8_t src, uint8_t dst, const uint8_t *<a class="el" href="structnonce.html">nonce</a>)</td></tr>
<tr class="memitem:gaf594e61a4eff847243163fb3d0a71b74" id="r_gaf594e61a4eff847243163fb3d0a71b74"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf594e61a4eff847243163fb3d0a71b74">sec0_send_data</a> (<a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *p, const void *<a class="el" href="Serialapi_8c.html#a43a278d13284fb3412e9eee1db1d967e">data</a>, uint8_t len, <a class="el" href="sl__ts__param_8h.html#ad477ad820bb5da4e739cb6405228db10">ZW_SendDataAppl_Callback_t</a> callback, void *user)</td></tr>
<tr class="memitem:gaf84a8d99bf2204c50da699fdaee63856" id="r_gaf84a8d99bf2204c50da699fdaee63856"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf84a8d99bf2204c50da699fdaee63856">sec0_set_key</a> (uint8_t *netkey)</td></tr>
<tr class="memitem:ga8fa0a51e17f3f699b8b1f71b6a0f161e" id="r_ga8fa0a51e17f3f699b8b1f71b6a0f161e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8fa0a51e17f3f699b8b1f71b6a0f161e">sec0_reset_netkey</a> ()</td></tr>
<tr class="memitem:ga577e9264b293506f05c818133f616a71" id="r_ga577e9264b293506f05c818133f616a71"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga577e9264b293506f05c818133f616a71">sec0_decrypt_message</a> (uint8_t snode, uint8_t dnode, const uint8_t *enc_data, uint8_t enc_data_length, uint8_t *dec_message)</td></tr>
<tr class="memitem:ga9bd957c1911be59ffcd34839752427fa" id="r_ga9bd957c1911be59ffcd34839752427fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9bd957c1911be59ffcd34839752427fa">sec0_send_nonce</a> (<a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *src)</td></tr>
<tr class="memitem:gad025a348dca96964fb26571622b17fc6" id="r_gad025a348dca96964fb26571622b17fc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad025a348dca96964fb26571622b17fc6">sec0_init</a> ()</td></tr>
<tr class="memitem:gab8274e866bca31570203bb65896afbcc" id="r_gab8274e866bca31570203bb65896afbcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab8274e866bca31570203bb65896afbcc">sec0_abort_all_tx_sessions</a> ()</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga0a6015206b02652cd3b7ab1639359127" id="r_ga0a6015206b02652cd3b7ab1639359127"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0a6015206b02652cd3b7ab1639359127">networkKey</a> [16]</td></tr>
<tr class="memitem:ga9938d75782686b8fbdeade51802a9e58" id="r_ga9938d75782686b8fbdeade51802a9e58"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9938d75782686b8fbdeade51802a9e58">sec_learn_complete_t</a>) (int status)</td></tr>
<tr class="memitem:gaa586e1c67ea5e069d72c1bf508b1bca2" id="r_gaa586e1c67ea5e069d72c1bf508b1bca2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa586e1c67ea5e069d72c1bf508b1bca2">security_init</a> ()</td></tr>
<tr class="memitem:ga5f1f8e41dbd00cf9a3d2f4acf230c3ad" id="r_ga5f1f8e41dbd00cf9a3d2f4acf230c3ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5f1f8e41dbd00cf9a3d2f4acf230c3ad">security_set_supported_classes</a> (uint8_t *classes, uint8_t n_classes)</td></tr>
<tr class="memitem:ga866759b643c327f82c9f902f14499c34" id="r_ga866759b643c327f82c9f902f14499c34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga866759b643c327f82c9f902f14499c34">security_set_default</a> ()</td></tr>
<tr class="memitem:gabae116139d30a39edf4b567cbff74ee8" id="r_gabae116139d30a39edf4b567cbff74ee8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabae116139d30a39edf4b567cbff74ee8">security_learn_begin</a> (<a class="el" href="#ga9938d75782686b8fbdeade51802a9e58">sec_learn_complete_t</a> __cb)</td></tr>
<tr class="memitem:gaa6b9c428ef688bf817acfae007aa3cbd" id="r_gaa6b9c428ef688bf817acfae007aa3cbd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa6b9c428ef688bf817acfae007aa3cbd">security_add_begin</a> (uint8_t node, uint8_t txOptions, <a class="el" href="ZW__typedefs_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> controller, <a class="el" href="#ga9938d75782686b8fbdeade51802a9e58">sec_learn_complete_t</a> __cb)</td></tr>
<tr class="memitem:gad69c0fa66a6ddd822473e13bc7e9c7b4" id="r_gad69c0fa66a6ddd822473e13bc7e9c7b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad69c0fa66a6ddd822473e13bc7e9c7b4">security_CommandHandler</a> (<a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *p, const <a class="el" href="ZW__classcmd_8h.html#a1590767159ef920152671d72a42e8ae0">ZW_APPLICATION_TX_BUFFER</a> *pCmd, <a class="el" href="ZW__typedefs_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cmdLength)</td></tr>
<tr class="memitem:ga640f0759b1a4cd296a65722a0eb7e58b" id="r_ga640f0759b1a4cd296a65722a0eb7e58b"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga640f0759b1a4cd296a65722a0eb7e58b">is_sec0_key_granted</a> ()</td></tr>
<tr class="memitem:gac0bc3f19cb7a463c07adfac086a6baa6" id="r_gac0bc3f19cb7a463c07adfac086a6baa6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac0bc3f19cb7a463c07adfac086a6baa6">secure_poll</a> ()</td></tr>
<tr class="memitem:gaa4a4f0a01ba68568350ee38e5c4f7ce9" id="r_gaa4a4f0a01ba68568350ee38e5c4f7ce9"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa4a4f0a01ba68568350ee38e5c4f7ce9">secure_learn_active</a> ()</td></tr>
<tr class="memitem:gaa89fba87d6e8dc0eb0d332adbcaa880d" id="r_gaa89fba87d6e8dc0eb0d332adbcaa880d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa89fba87d6e8dc0eb0d332adbcaa880d">sec0_abort_inclusion</a> ()</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Implementation of Security Scheme 0: these functions handle the inclusion protocol and the secure transmission and receive sessions. </p>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="ga9938d75782686b8fbdeade51802a9e58" name="ga9938d75782686b8fbdeade51802a9e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9938d75782686b8fbdeade51802a9e58">&#9670;&#160;</a></span>sec_learn_complete_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* sec_learn_complete_t) (int status)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Indicate that the secure inclusion or learn mode has completed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>&lt; 0 for failure 0 for non-secure &gt;0 for secure . </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga640f0759b1a4cd296a65722a0eb7e58b" name="ga640f0759b1a4cd296a65722a0eb7e58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga640f0759b1a4cd296a65722a0eb7e58b">&#9670;&#160;</a></span>is_sec0_key_granted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t is_sec0_key_granted </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query if an S0 key is granted. This function checks if an S0 key has been written to the keystore. </p><dl class="section return"><dt>Returns</dt><dd>TRUE if S0 key has been granted, FALSE otherwise. </dd></dl>

</div>
</div>
<a id="gab8274e866bca31570203bb65896afbcc" name="gab8274e866bca31570203bb65896afbcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab8274e866bca31570203bb65896afbcc">&#9670;&#160;</a></span>sec0_abort_all_tx_sessions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_abort_all_tx_sessions </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cancel all transmit sessions. </p>

</div>
</div>
<a id="gaa89fba87d6e8dc0eb0d332adbcaa880d" name="gaa89fba87d6e8dc0eb0d332adbcaa880d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa89fba87d6e8dc0eb0d332adbcaa880d">&#9670;&#160;</a></span>sec0_abort_inclusion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_abort_inclusion </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Abort the current inclusion. </p>

</div>
</div>
<a id="ga577e9264b293506f05c818133f616a71" name="ga577e9264b293506f05c818133f616a71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga577e9264b293506f05c818133f616a71">&#9670;&#160;</a></span>sec0_decrypt_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sec0_decrypt_message </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>snode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>dnode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>enc_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>enc_data_length</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>dec_message</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt an encrypted message, returning the length of the decrypted message. The decrypted message is written into dec_message. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snode</td><td>source node </td></tr>
    <tr><td class="paramname">dnode</td><td>destination node </td></tr>
    <tr><td class="paramname">enc_data</td><td>pointer to the encrypted data, enc_data is modified by this function an will contain a pater of the decrypted message when this function returns </td></tr>
    <tr><td class="paramname">enc_data_length</td><td>Length of the encrypted data. </td></tr>
    <tr><td class="paramname">dec_message</td><td>The decrypted message is written into this pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The length of the decrypted message, 0 if decryption fails. </dd></dl>

</div>
</div>
<a id="gad025a348dca96964fb26571622b17fc6" name="gad025a348dca96964fb26571622b17fc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad025a348dca96964fb26571622b17fc6">&#9670;&#160;</a></span>sec0_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_init </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the security transport layer, which resets all sessions and stops all timers. </p>

</div>
</div>
<a id="ga9f0c343b5ae18964fdbf640727d3a63d" name="ga9f0c343b5ae18964fdbf640727d3a63d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f0c343b5ae18964fdbf640727d3a63d">&#9670;&#160;</a></span>sec0_register_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_register_nonce </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>dst</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>nonce</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a nonce by source and destination.</p>
<p>Register a nonce by source and destination </p>

</div>
</div>
<a id="ga8fa0a51e17f3f699b8b1f71b6a0f161e" name="ga8fa0a51e17f3f699b8b1f71b6a0f161e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8fa0a51e17f3f699b8b1f71b6a0f161e">&#9670;&#160;</a></span>sec0_reset_netkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_reset_netkey </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a new net key. </p>

</div>
</div>
<a id="gaf594e61a4eff847243163fb3d0a71b74" name="gaf594e61a4eff847243163fb3d0a71b74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf594e61a4eff847243163fb3d0a71b74">&#9670;&#160;</a></span>sec0_send_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sec0_send_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sl__ts__param_8h.html#ad477ad820bb5da4e739cb6405228db10">ZW_SendDataAppl_Callback_t</a></td>          <td class="paramname"><span class="paramname"><em>callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga9bd957c1911be59ffcd34839752427fa" name="ga9bd957c1911be59ffcd34839752427fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9bd957c1911be59ffcd34839752427fa">&#9670;&#160;</a></span>sec0_send_nonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_send_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *</td>          <td class="paramname"><span class="paramname"><em>src</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a nonce to the snode in src. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>the nonce is sent to src-&gt;snode</td></tr>
  </table>
  </dd>
</dl>
<p>Send a nonce from given source to given destination. The nonce is registered internally </p>

</div>
</div>
<a id="gaf84a8d99bf2204c50da699fdaee63856" name="gaf84a8d99bf2204c50da699fdaee63856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf84a8d99bf2204c50da699fdaee63856">&#9670;&#160;</a></span>sec0_set_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sec0_set_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>netkey</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the network key used.</p>
<p>Set the network key </p>

</div>
</div>
<a id="gaa4a4f0a01ba68568350ee38e5c4f7ce9" name="gaa4a4f0a01ba68568350ee38e5c4f7ce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa4a4f0a01ba68568350ee38e5c4f7ce9">&#9670;&#160;</a></span>secure_learn_active()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t secure_learn_active </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>TRUE if we are in learnmode or add node </dd></dl>

</div>
</div>
<a id="gac0bc3f19cb7a463c07adfac086a6baa6" name="gac0bc3f19cb7a463c07adfac086a6baa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac0bc3f19cb7a463c07adfac086a6baa6">&#9670;&#160;</a></span>secure_poll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void secure_poll </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State machine polling. </p>

</div>
</div>
<a id="gaa6b9c428ef688bf817acfae007aa3cbd" name="gaa6b9c428ef688bf817acfae007aa3cbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6b9c428ef688bf817acfae007aa3cbd">&#9670;&#160;</a></span>security_add_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t security_add_begin </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>node</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>txOptions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ZW__typedefs_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a></td>          <td class="paramname"><span class="paramname"><em>controller</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga9938d75782686b8fbdeade51802a9e58">sec_learn_complete_t</a></td>          <td class="paramname"><span class="paramname"><em>__cb</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Begin the add node mode. On completion, the callback function is called with scheme mask negotiated for the new node. An empty scheme mask means that the secure negotiation has failed. Call this only for nodes which support security.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>Node to negotiate with </td></tr>
    <tr><td class="paramname">txOptions</td><td>Transmit options </td></tr>
    <tr><td class="paramname">controller</td><td>TRUE if the node is a controller </td></tr>
    <tr><td class="paramname">__cb</td><td>callback function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad69c0fa66a6ddd822473e13bc7e9c7b4" name="gad69c0fa66a6ddd822473e13bc7e9c7b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad69c0fa66a6ddd822473e13bc7e9c7b4">&#9670;&#160;</a></span>security_CommandHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_CommandHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sl__ts__param_8h.html#a1a28f75977669a0019fc2b0700c67d50">ts_param_t</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ZW__classcmd_8h.html#a1590767159ef920152671d72a42e8ae0">ZW_APPLICATION_TX_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>pCmd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ZW__typedefs_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></td>          <td class="paramname"><span class="paramname"><em>cmdLength</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Input handler for the security state machine. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Reception parameters </td></tr>
    <tr><td class="paramname">pCmd</td><td>Payload from the received frame </td></tr>
    <tr><td class="paramname">cmdLength</td><td>Number of command bytes including the command </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa586e1c67ea5e069d72c1bf508b1bca2" name="gaa586e1c67ea5e069d72c1bf508b1bca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa586e1c67ea5e069d72c1bf508b1bca2">&#9670;&#160;</a></span>security_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_init </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the state machine one-time. </p>

</div>
</div>
<a id="gabae116139d30a39edf4b567cbff74ee8" name="gabae116139d30a39edf4b567cbff74ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabae116139d30a39edf4b567cbff74ee8">&#9670;&#160;</a></span>security_learn_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_learn_begin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#ga9938d75782686b8fbdeade51802a9e58">sec_learn_complete_t</a></td>          <td class="paramname"><span class="paramname"><em>__cb</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Begin the learn mode. On completion, the callback function is called with scheme mask negotiated for this node. An empty scheme mask means that the secure negotiation has failed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">__cb</td><td>callback function.</td></tr>
  </table>
  </dd>
</dl>
<p>Enter learn mode </p>

</div>
</div>
<a id="ga866759b643c327f82c9f902f14499c34" name="ga866759b643c327f82c9f902f14499c34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga866759b643c327f82c9f902f14499c34">&#9670;&#160;</a></span>security_set_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_set_default </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset security states. </p>

</div>
</div>
<a id="ga5f1f8e41dbd00cf9a3d2f4acf230c3ad" name="ga5f1f8e41dbd00cf9a3d2f4acf230c3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f1f8e41dbd00cf9a3d2f4acf230c3ad">&#9670;&#160;</a></span>security_set_supported_classes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void security_set_supported_classes </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>classes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>n_classes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the supported security classes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">classes</td><td>pointer to a byte array of command classes which are supported secure. </td></tr>
    <tr><td class="paramname">n_classes</td><td>length of the byte array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="ga0a6015206b02652cd3b7ab1639359127" name="ga0a6015206b02652cd3b7ab1639359127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0a6015206b02652cd3b7ab1639359127">&#9670;&#160;</a></span>networkKey</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t networkKey[16]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The master key, used by the security layer. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
